"use strict";angular.module("dcm-ui.slider",["dcm-ui.helpers.drag"]),angular.module("dcm-ui.slider").directive("dcmSlider",["$document","dragHelper","$window",function(e,t,n){return{restrict:"E",replace:!1,controller:function(){},scope:{datasource:"=",selected:"="},compile:function(){return function(e,a,r,o){var l=angular.element('<div class="dcm-slider">'),i=angular.element('<a class="dcm-slider-select-areas"></a>');l.append(i);var u=angular.element('<div class="dcm-slider-bar-container">'),s=angular.element('<div class="dcm-slider-bar">');u.append(s),l.append(u);var c=angular.element('<a class="dcm-slider-drag-handle"></a>');l.append(c),a.empty(),a.append(l),o.handleContent&&o.handleContent(function(e){c.append(e)});var d=[],g=[],p=-1,f=function(t){e.selected=t,p=e.datasource.indexOf(t),s.css({width:100*(p/(e.datasource.length-1))+"%"}),c.offset({left:s.offset().left+s.width()-c.width()/2})},m=function(){g=[],c.offset({top:u.offset().top+u.height()/2-c.height()/2}),angular.forEach(d,function(e){var t=e.offset().left;g.push({left:t,right:e.width()+t-1})}),f(e.selected&&-1!==e.datasource.indexOf(e.selected)?e.selected:e.datasource[Math.floor(e.datasource.length/2)])},h=0;t.draggable(c,{dragCursor:"col-resize",mouseDown:function(){h=c.offset(),c.addClass("resizing")},mouseMove:function(t){for(var n=h.left+c.width()/2+t.dX,a=0;a<g.length;a++)a!==p&&(n>=g[a].left&&n<=g[a].right?f(e.datasource[a]):0===a&&n<g[a].left?f(e.datasource[a]):a===g.length-1&&n>g[a].right&&f(e.datasource[a]))},mouseUp:function(){c.removeClass("resizing")}}),e.$watchCollection("datasource",function(t){if(i.empty(),d=[],t&&t.length>1){var n,a=Math.floor(1e6/(t.length-1))/1e4,r=l.outerHeight(!1);angular.forEach(t,function(o,l){var u=angular.element('<a class="dcm-slider-select-area">');n=0===l||l===t.length-1?(a/2).toString()+"%":a.toString()+"%",u.css({"float":"left",width:n,height:r+"px"}),u.on("click",function(t){e.$apply(function(){f(o,u)}),t.stopPropagation(),t.preventDefault()}),i.append(u),d.push(u);var s=angular.element('<div class="dcm-slider-mark">');0===l?s.addClass("first"):l===t.length-1&&s.addClass("last"),u.append(s)}),m()}else t&&1===t.length?e.selected=t[0]:e.selected=void 0}),e.$watchCollection("selected",function(t,n){t!==n&&f(t||-1!==e.datasource.indexOf(t)?t:e.datasource[Math.floor(e.datasource.length/2)])});var v=function(){e.$apply(function(){m()})};angular.element(n).bind("resize",v),e.$on("$destroy",function(){angular.element(n).unbind("resize",v)}),e.$watch(function(){return l[0].offsetWidth},function(e,t){e!==t&&m()})}}}}]),angular.module("dcm-ui.slider").directive("dcmSliderHandle",[function(){return{restrict:"E",require:"^dcmSlider",priority:100,scope:!1,transclude:!0,compile:function(){return function(e,t,n,a,r){a.handleContent=r}}}}]);
//# sourceMappingURL=dcm-ui-slider.min.js.map