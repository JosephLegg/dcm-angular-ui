"use strict";angular.module("dcm-ui.slider",["dcm-ui.helpers.drag"]),angular.module("dcm-ui.slider").directive("dcmSlider",["$document","dragHelper","$window",function(e,t,a){return{restrict:"E",replace:!1,controller:function(){},scope:{datasource:"=",selected:"="},compile:function(){return function(e,n,r,o){var i=angular.element('<div class="dcm-slider">'),l=angular.element('<a class="dcm-slider-select-areas"></a>');i.append(l);var c=angular.element('<div class="dcm-slider-bar-container">'),d=angular.element('<div class="dcm-slider-bar">');c.append(d),i.append(c);var s=angular.element('<a class="dcm-slider-drag-handle"></a>');i.append(s),n.empty(),n.append(i),o.handleContent&&o.handleContent(function(e){s.append(e)});var u=[],f=[],g=-1,p=function(t){e.selected=t,g=e.datasource.indexOf(t),d.css({width:100*(g/(e.datasource.length-1))+"%"}),s.offset({left:d.offset().left+d.width()-s.width()/2})},m=function(){f=[],s.offset({top:c.offset().top+c.height()/2-s.height()/2}),angular.forEach(u,function(e){var t=e.offset().left;f.push({left:t,right:e.width()+t-1})}),p(e.selected&&-1!==e.datasource.indexOf(e.selected)?e.selected:e.datasource[Math.floor(e.datasource.length/2)])},v=0;t.draggable(s,{dragCursor:"col-resize",mouseDown:function(){v=s.offset(),s.addClass("resizing")},mouseMove:function(t){for(var a=v.left+s.width()/2+t.dX,n=0;n<f.length;n++)n!==g&&(a>=f[n].left&&a<=f[n].right?p(e.datasource[n]):0===n&&a<f[n].left?p(e.datasource[n]):n===f.length-1&&a>f[n].right&&p(e.datasource[n]))},mouseUp:function(){s.removeClass("resizing")}}),e.$watchCollection("datasource",function(t){if(l.empty(),u=[],t&&t.length>1){var a,n=Math.floor(1e6/(t.length-1))/1e4,r=i.outerHeight(!1);angular.forEach(t,function(o,i){var c=angular.element('<a class="dcm-slider-select-area">');a=0===i||i===t.length-1?(n/2).toString()+"%":n.toString()+"%",c.css({"float":"left",width:a,height:r+"px"}),c.on("click",function(t){e.$apply(function(){p(o,c)}),t.stopPropagation(),t.preventDefault()}),l.append(c),u.push(c);var d=angular.element('<div class="dcm-slider-mark">');0===i?d.addClass("first"):i===t.length-1&&d.addClass("last"),c.append(d)}),m()}else t&&1===t.length?e.selected=t[0]:e.selected=void 0}),e.$watchCollection("selected",function(t,a){t!==a&&p(t||-1!==e.datasource.indexOf(t)?t:e.datasource[Math.floor(e.datasource.length/2)])});var h=function(){e.$apply(function(){m()})};angular.element(a).bind("resize",h),e.$on("$destroy",function(){angular.element(a).unbind("resize",h)}),e.$watch(function(){return i[0].offsetWidth},function(e,t){e!==t&&m()})}}}}]),angular.module("dcm-ui.slider").directive("dcmSliderHandle",[function(){return{restrict:"E",require:"^dcmSlider",priority:100,scope:!1,transclude:!0,compile:function(){return function(e,t,a,n,r){n.handleContent=r}}}}]);
//# sourceMappingURL=dcm-ui-slider.min.js.map