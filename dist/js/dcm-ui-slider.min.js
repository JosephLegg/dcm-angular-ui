"use strict";angular.module("dcm-ui.slider",["dcm-ui.helpers.drag"]),angular.module("dcm-ui.slider").directive("dcmSlider",["$document","dragHelper","$window","$timeout",function(a,b,c){return{restrict:"E",replace:!1,controller:function(){},scope:{datasource:"=",selected:"="},compile:function(){var a=angular.element('<div class="dcm-slider">'),d=angular.element('<a class="dcm-slider-select-areas"></a>');a.append(d);var e=angular.element('<div class="dcm-slider-bar-container">'),f=angular.element('<div class="dcm-slider-bar">');e.append(f),a.append(e);var g=angular.element('<a class="dcm-slider-drag-handle"></a>');return a.append(g),function(h,i,j,k){i.empty(),i.append(a),k.handleContent&&k.handleContent(function(a){g.append(a)});var l=[],m=[],n=-1,o=function(a){h.selected=a,n=h.datasource.indexOf(a),f.css({width:100*(n/(h.datasource.length-1))+"%"}),g.offset({left:f.offset().left+f.width()-g.width()/2})},p=function(){m=[],g.offset({top:e.offset().top+e.height()/2-g.height()/2}),angular.forEach(l,function(a){var b=a.offset().left;m.push({left:b,right:a.width()+b-1})}),o(h.selected&&-1!==h.datasource.indexOf(h.selected)?h.selected:h.datasource[Math.floor(h.datasource.length/2)])},q=0;b.draggable(g,{dragCursor:"col-resize",mouseDown:function(){q=g.offset(),g.addClass("resizing")},mouseMove:function(a){for(var b=q.left+g.width()/2+a.dX,c=0;c<m.length;c++)c!==n&&(b>=m[c].left&&b<=m[c].right?o(h.datasource[c]):0===c&&b<m[c].left?o(h.datasource[c]):c===m.length-1&&b>m[c].right&&o(h.datasource[c]))},mouseUp:function(){g.removeClass("resizing")}}),h.$watchCollection("datasource",function(b){if(d.empty(),l=[],b&&b.length>1){var c,e=Math.floor(1e6/(b.length-1))/1e4,f=a.outerHeight(!1);angular.forEach(b,function(a,g){var i=angular.element('<a class="dcm-slider-select-area">');c=0===g||g===b.length-1?(e/2).toString()+"%":e.toString()+"%",i.css({"float":"left",width:c,height:f+"px"}),i.on("click",function(b){h.$apply(function(){o(a,i)}),b.stopPropagation(),b.preventDefault()}),d.append(i),l.push(i);var j=angular.element('<div class="dcm-slider-mark">');0===g?j.addClass("first"):g===b.length-1&&j.addClass("last"),i.append(j)}),p()}else h.selected=b&&1===b.length?b[0]:void 0}),h.$watchCollection("selected",function(a,b){a!==b&&o(a||-1!==h.datasource.indexOf(a)?a:h.datasource[Math.floor(h.datasource.length/2)])});var r=function(){h.$apply(function(){p()})};angular.element(c).bind("resize",r),h.$on("$destroy",function(){angular.element(c).unbind("resize",r)}),h.$watch(function(){return a[0].offsetWidth},function(a,b){a!==b&&p()})}}}}]),angular.module("dcm-ui.slider").directive("dcmSliderHandle",[function(){return{restrict:"E",require:"^dcmSlider",priority:100,scope:!1,transclude:!0,compile:function(){return function(a,b,c,d,e){d.handleContent=e}}}}]);
//# sourceMappingURL=dcm-ui-slider.min.js.map