"use strict";angular.module("dcm-ui.grid",[]),angular.module("dcm-ui.grid").controller("DCMGridCtrl",["$scope","$compile","$log","$interpolate","$timeout",function(e,t,a,n,r){var o=this,i=[],l=[];e.storeConfig&&localStorage[e.storeConfig]&&(a.info("GRID: attempting to load grid config from local storage"),l=JSON.parse(localStorage[e.storeConfig])),e.hasOwnProperty("columns")&&angular.isArray(e.columns)&&(i=e.columns);var c=o.columns=e.columns=[];e.hasOwnProperty("editColumns")&&(e.editColumns=c,e.editColumns.update=function(){o.redrawGrid()}),o.rowActionContent="",o.oRowActions=void 0,o.headerRow="",o.aRows=[];var d=0,u={};o.getGridDataID=function(t){return t.hasOwnProperty("$$gridDataID")||(d++,t.$$gridDataID=e.$id+"-"+d.toString()),t.$$gridDataID},o.getGridData=function(e){var t=o.getGridDataID(e);return u.hasOwnProperty(t)?u[t]:null},o.putGridData=function(e,t){u[e]=t},o.addColumn=function(e){var t=_.where(l,{title:e.title,content:e.content});t.length||(t=_.where(i,{title:e.title,content:e.content})),t.length&&(e.sortDefault=t[0].sortDefault,e.width=t[0].width,e.enabled=t[0].enabled),c.push(e)},o.redrawGrid=function(){o.tableBody.empty(),o.tableHead.empty(),o.tableHead.append(o.generateHeaderRow()),o.generateTemplates(),t(o.tableHead)(e);for(var n=0,r=o.aRows.length;r>n;n++){var i=o.aRows[n],l=o.getGridData(i);l.row=o.rowTemplate(l.scope,angular.noop),l.checkbox=l.row.find("td.dcm-grid-selectable i"),o.tableBody.append(l.row)}a.info("GRID: templates regenerated + table updated"),o.storeConfig()},o.getColWidthPct=function(e){return Math.round(e.outerWidth(!0)/o.headerRow.width()*1e4)/100},e.$on("TABLE_COL_RESIZED",function(){var e=0,t=o.headerRow.children();o.bEnableActive&&e++,angular.forEach(o.columns,function(a){if(a.enabled){var n=angular.element(t[e]);a.width=o.getColWidthPct(n).toString()+"%",e++}}),o.storeConfig()}),o.storeConfig=function(){if(e.storeConfig){var t=_.map(c,function(e){return{width:e.width,sortDefault:e.sortDefault,enabled:e.enabled,title:e.title,content:e.content}});localStorage[e.storeConfig]=JSON.stringify(t),a.info("GRID: grid config saved to local storage")}},o.oRowAttributes={},o.addRowAttributes=function(e){angular.extend(o.oRowAttributes,e)},o.oRowActionsAttributes={},o.addRowActionsAttributes=function(e){angular.extend(o.oRowActionsAttributes,e)},o.getSelectedAsArray=function(){if("single"===o.selectType){var t=[];return e.selected&&t.push(e.selected),t}return e.selected},o.selectedPosition=function(e){return _.indexOf(o.getSelectedAsArray(),e.data)},o.toggleSelected=function(t){var a,n,r;if(t)for(n=0,r=e.datasource.length;r>n;n++)a=o.getGridData(e.datasource[n]),a.checkbox.hasClass(o.checkedIcon)||o.addSelected(a);else for(n=e.selected.length-1;n>=0;n--)a=o.getGridData(e.selected[n]),o.removeSelected(a)},o.addSelected=function(t){"single"===o.selectType?(e.selected&&e.selected!==t.data&&o.removeSelected(o.getGridData(e.selected)),e.selected=t.data):e.selected.push(t.data),t.scope.$row.checked=!0,o.bEnableActive&&o.oRowActions&&e.activeRow===t.data&&o.oRowActions.addClass("selected")},o.removeSelected=function(t){"single"===o.selectType?e.selected=null:e.selected.splice(o.selectedPosition(t),1),t.scope.$row.checked=!1,o.bEnableActive&&o.oRowActions&&e.activeRow===t.data&&o.oRowActions.removeClass("selected")},o.mergeAttributes=function(e,t){angular.forEach(t,function(t,a){"ng-class"===a&&e.attr("ng-class")?e.attr(a,(e.attr("ng-class")+t).replace(/}\s*{/,", ")):e.attr(a,t)})},o.rowTemplate=angular.noop,o.activeRowTemplate=angular.noop,o.generateTemplates=function(){var e,a,n=angular.element('<tr ng-class="{selected: $row.checked}">');o.mergeAttributes(n,o.oRowAttributes);for(var r=0,i=o.columns.length;i>r;r++)e=o.columns[r],e.enabled&&(a=angular.element("<td>"),a.append(e.content),o.mergeAttributes(a,e.attributes),n.append(a));if(o.bEnableSelect){var l="{'"+o.checkedIcon+"': $row.checked, '"+o.notCheckedIcon+"': !$row.checked }",c=angular.element('<i class="fa" ng-class="'+l+'"></i>');n.append(angular.element('<td ng-click="toggleChecked($row, $event);" class="dcm-grid-selectable"></td>').append(c))}if(o.bEnableActive?(n.attr("ng-click","toggleActiveRow($row)"),n.prepend(angular.element('<td class="dcm-grid-activemarker"></td>'))):o.bEnableSelect&&n.attr("ng-click","toggleChecked($row, $event)"),o.rowTemplate=t(n),o.bRowActions){var d=angular.element('<tr class="dcm-grid-details">');o.mergeAttributes(d,o.oRowActionsAttributes);var u=o.colCount-1,s=angular.element('<td ng-click="" colspan="'+u+'">').html(o.rowActionContent);o.bEnableActive&&d.append(angular.element('<td class="dcm-grid-activemarker"></td>')),d.append(s),o.activeRowTemplate=t(d)}},o.generateHeaderRow=function(){o.colCount=0;for(var a=-1,r=0;r<o.columns.length;r++)o.columns[r].enabled&&(a=r);var i=angular.element("<tr>");if(angular.forEach(o.columns,function(a){if(a.enabled){a.icon="",o.colCount++;var r,l=e.$new(!1);l.column=a,r=t('<a>{{column.title}}<i class="fa" ng-if="column.icon" ng-class="column.icon"></a>')(l);var c=angular.element('<th class="resizable-column">').append(r);if(c.css("width",a.width?a.width:"auto"),o.sortable){var d;switch(d=a.field?function(e){return e[a.field]}:n(a.content),a.sortType){case"string":a.sortFunction=function(e){var t=d(e)||"";return t.toLowerCase()};break;case"integer":a.sortFunction=function(e){var t=d(e);return t=t?t:0,parseInt(t,10)};break;case"datetime":a.sortFunction=function(e){var t=new Date(d(e));return t.getTime()};break;case"direct":a.sortFunction=d;break;default:var u;a.sortFunction=function(e){var t=d(e);switch(u||(u=typeof t,"string"===u&&t.match(/^\d{4,4}-\d\d-\d\dT\d\d:\d\d:\d\dZ$/)&&(u="datetime")),u){case"string":return t?t.toLowerCase():"";case"datetime":return t?t:"";default:return t?t:""}}}a.sortDefault&&(e.sortFunction=a.sortFunction,o.currentSort&&o.currentSort!==a&&(o.currentSort.sortDefault=!1),o.currentSort=a,e.sortOrder=a.sortDefault.toUpperCase(),"ASC"===e.sortOrder?a.icon="fa-angle-up":a.icon="fa-angle-down"),c.bind("click",function(){e.$apply(function(){o.currentSort?(o.currentSort.icon="",o.currentSort===a&&"DESC"!==e.sortOrder?(e.sortOrder="DESC",a.icon="fa-angle-down"):(e.sortOrder="ASC",a.icon="fa-angle-up")):(e.sortOrder="ASC",a.icon="fa-angle-up"),o.currentSort!==a&&(o.currentSort&&(o.currentSort.sortDefault=!1),e.sortFunction=a.sortFunction,o.currentSort=a),o.currentSort.sortDefault=e.sortOrder,o.storeConfig()})})}i.append(c)}}),o.bEnableSelect){o.colCount++;var l=angular.element('<th class="dcm-grid-selectable"></th>');if("single"!==o.selectType){var c=angular.element('<i class="fa fa-square-o">');c.bind("click",function(){e.$apply(function(){var e=c.hasClass(o.checkedIcon);o.toggleSelected(!e)})}),l.append(c),o.unbindBulkCheck&&o.unbindBulkCheck(),o.unbindBulkCheck=e.$watchCollection("selected",function(e){var t=e.length&&e.length===o.aRows.length;c.removeClass("fa-check-square-o fa-square-o").addClass(t?o.checkedIcon:o.notCheckedIcon)})}i.append(l)}return o.bEnableActive&&(o.colCount++,i.prepend(angular.element('<th class="dcm-grid-activemarker"></th>')),e.$watch("activeRow",function(e,t){o.removeActiveRow(t),o.setActiveRow(e)})),o.headerRow=i,i},o.removeActiveRow=function(t){if(t=t||e.activeRow){var a=o.getGridData(t);a&&a.row&&a.row.removeClass("active"),e.activeRow=void 0}o.oRowActions&&o.oRowActions.remove()};var s=function(e){if(e&&e.hasOwnProperty("row")){if(e.row.addClass("active"),o.bRowActions){var t=o.activeRowTemplate(e.scope,angular.noop);o.bEnableSelect&&-1!==o.selectedPosition(e)&&t.addClass("selected"),o.oRowActions=t,e.row.after(o.oRowActions)}}else o.removeActiveRow()};o.setActiveRow=function(t){if(o.removeActiveRow(),t){e.activeRow=t;var a=o.getGridData(t);a&&a.hasOwnProperty("row")?s(a):r(function(){s(a)},0)}},e.$on("$destroy",function(){if(o.bEnableActive&&e.activeRow&&o.removeActiveRow(),o.bEnableSelect)for(var t=o.getSelectedAsArray(),a=t.length-1;a>=0;a--){var n=o.getGridData(t[a]);o.removeSelected(n)}})}]),angular.module("dcm-ui.grid").directive("dcmGridColumn",[function(){return{require:"^dcmGrid",restrict:"E",scope:{field:"@",title:"@",width:"@",enabled:"@",sortType:"@",sortDefault:"@",resizable:"@"},compile:function(e,t){var a=$.trim(e.html());return function(e,n,r,o){var i={};angular.forEach(r,function(t,a){"$"!==a[0]&&void 0===e[a]&&""!==t&&(i[a.replace(/([A-Z])/g,"-$1").toLowerCase()]=t)});var l={content:a,attributes:i,enabled:void 0!==r.enabled?"false"!==r.enabled.toLowerCase():!0,title:e.title,width:e.width,resizable:void 0!==r.resizable?"false"!==r.resizable.toLowerCase():!0,field:r.field,sortType:e.sortType||"",sortDefault:void 0!==r.sortDefault?r.sortDefault||"ASC":!1};if(!r.field||""===r.field){var c=a.match(/^\s*{{\s*(\S+)\s*}}\s*$/);c&&(l.field=c[1])}void 0===t.title&&l.field&&""!==l.field&&(l.title=l.field[0].toUpperCase()+l.field.slice(1)),o.addColumn(l)}}}}]),angular.module("dcm-ui.grid").directive("dcmGrid",["$animate","$log","$compile","$window",function(e,t,a,n){return{restrict:"E",require:"dcmGrid",scope:{datasource:"=",activeRow:"=?",selected:"=?",additionalRowData:"=?",sortFunction:"=?",sortOrder:"=?",editColumns:"=?",storeConfig:"@"},controller:"DCMGridCtrl",compile:function(){return function(r,o,i,l){l.bEnableSelect=!!i.selected,l.bEnableActive=!!i.activeRow,l.sortable=!!i.sortFunction,l.selectType=i.selectType?i.selectType.toLowerCase():"multiple","multiple"===l.selectType?(l.checkedIcon="fa-check-square-o",l.notCheckedIcon="fa-square-o"):(l.checkedIcon="fa-dot-circle-o",l.notCheckedIcon="fa-circle-o"),r.additionalRowData&&(l.additionalRowData=r.additionalRowData);var c=l.tableHead=angular.element("<thead>"),d=l.tableBody=angular.element("<tbody>"),u=l.table=angular.element('<table class="dcm-grid-table resizable-columns">');i.width&&u.css("width",i.width),u.append(c),c.append(l.generateHeaderRow()),a(u)(r),l.generateTemplates();var s=[],f={};l.bEnableSelect&&"single"===l.selectType&&r.$watch("selected",function(e,t){var a;e!==t&&(t&&(a=l.getGridData(t),a&&l.removeSelected(a)),e&&(a=l.getGridData(e),a?l.addSelected(a):r.selected=null))}),r.$watchCollection("datasource",function(a){var o=(new Date).getTime();l.aRows=a;var i,c=[];if(_.isArray(a)||(a=[]),l.bEnableActive&&r.activeRow&&(-1!==_.indexOf(a,r.activeRow)&&(t.info("GRID: storing active row to reopen later"),i=r.activeRow),l.removeActiveRow()),l.bEnableSelect){c=l.getSelectedAsArray();for(var u=c.length-1;u>=0;u--)if(-1===_.indexOf(a,c[u])){var m=l.getGridData(c[u]);m?l.removeSelected(m):"single"===l.selectType?r.selected=null:r.selected.splice(u,1)}}r.toggleActiveRow=function(e){var t=n.getSelection().toString();t||(r.activeRow===e.data?l.removeActiveRow():l.setActiveRow(e.data))},r.toggleChecked=function(e,t){e.checked=!e.checked,e.checked?l.addSelected(e.record):l.removeSelected(e.record),t.stopPropagation()};for(var v,w,h,b,D=[],C={},A=function(e,t){var a=this;a[t]=e,a.$watch("$$gridData."+t,function(e){e!==a[t]&&(a[t]=e)})},R=0,$=a.length;$>R;R++){var S=a[R];if(v=l.getGridDataID(S),w=l.getGridData(S),!w||!_.isEqual(w.lastValue,S)){var y=r.$new(!1),P=S,O={};y.$$gridData=a[R],angular.forEach(S,A,y),l.additionalRowData&&angular.extend(y,l.additionalRowData),y.$row={checked:-1!==_.indexOf(c,P)?!0:!1,data:P,record:O},angular.extend(O,{scope:y,data:P,lastValue:_.clone(P),id:v}),l.putGridData(v,O),l.bEnableActive&&r.activeRow===P&&l.setActiveRow(P.data),w=O}C[v]=D.length,D.push(w)}for(R=s.length-1;R>=0;R--)w=s[R],C.hasOwnProperty(w.id)||(h=f[w.id],delete f[w.id],s.splice(h,1),R-1<s.length-1&&p(R,s.length),e.leave(w.row));for(R=0,$=D.length;$>R;R++)w=D[R],s.length>=R&&s[R]===w||(f.hasOwnProperty(w.id)?(0===R?e.move(w.row,d,null):e.move(w.row,d,s[R-1].row),b=f[w.id],s.splice(b,1),s.splice(R,0,w),f[w.id]=R,g(R+1,b+1)):(w.row=l.rowTemplate(w.scope,angular.noop),w.checkbox=w.row.find("td.dcm-grid-selectable i"),0===R?e.enter(w.row,d,null):e.enter(w.row,d,s[R-1].row),s.splice(R,0,w),f[w.id]=R,R+1<s.length&&g(R+1,s.length)));i&&(t.info("GRID: restoring active row"),l.setActiveRow(i));var F=(new Date).getTime()-o;t.info("GRID: Update after data change "+F+"ms")});var g=function(e,t){_.each(_.range(e,t),function(e){f[s[e].id]++})},p=function(e,t){_.each(_.range(e,t),function(e){f[s[e].id]--})};u.append(d),o.empty().append(u)}}}}]),angular.module("dcm-ui.grid").directive("dcmGridRowActions",[function(){return{require:"^dcmGrid",restrict:"E",scope:!1,compile:function(e){return function(t,a,n,r){r.rowActionContent=$.trim(e.html()),r.bRowActions=!0;var o={};angular.forEach(n,function(e,a){"$"!==a[0]&&void 0===t[a]&&""!==e&&(o[a.replace(/([A-Z])/g,"-$1").toLowerCase()]=e)}),r.addRowActionsAttributes(o)}}}}]),angular.module("dcm-ui.grid").directive("dcmGridRow",[function(){return{require:"^dcmGrid",restrict:"E",scope:!1,compile:function(){return function(e,t,a,n){var r={};angular.forEach(a,function(t,a){"$"!==a[0]&&void 0===e[a]&&""!==t&&(r[a.replace(/([A-Z])/g,"-$1").toLowerCase()]=t)}),n.addRowAttributes(r)}}}}]),angular.module("dcm-ui.grid").factory("datasource",["$timeout","$q","$log","$http",function(e,t,a,n){var r={create:function(r,o){var i,l,c,d,u,s,f,g,p,m,v,w,h=null,b={type:"get"},D={perPage:5};o.hasOwnProperty("autoLoad")||(o.autoLoad=!0),o.hasOwnProperty("requestDataFunction")||(o.requestDataFunction=function(a){var r=t.defer(),o=function(){n(a).then(function(t){var n=t.data;r.notify(n.hasOwnProperty("data")?n.data:n),n.complete||!n.hasOwnProperty("complete")?r.resolve():n.hasOwnProperty("complete")&&n.token&&(a.hasOwnProperty("params")||(a.params={}),a.params.token=n.token,e(function(){o()},250))},r.reject)};return o(),r.promise});var C=function(){if(v&&O.data.length){O.bFiltering=!0;var e=new Date;"ASC"!==O.sortOrder&&O.data.reverse(),O.data=_.sortBy(O.data,v),"ASC"!==O.sortOrder&&O.data.reverse();var t=new Date-e;a.info("DATASOURCE: Sort "+t+"ms"),O.bPaused?("ASC"!==O.sortOrder&&O.viewData.reverse(),O.viewData=_.sortBy(O.viewData,v),"ASC"!==O.sortOrder&&O.viewData.reverse(),P(),O.bFiltering=!1):y()}};r.$watch(function(){return O.sortFunction},function(e){v=e,C()});var A;r.$watch(function(){return O.sortOrder},function(e){("DESC"===e||A&&A===v)&&(O.data.reverse(),O.viewData.reverse(),P(),O.bFiltering=!1),A=v}),o.hasOwnProperty("pagination")&&(g=angular.extend({},D,o.pagination),u=r.$watchCollection(function(){return o.pagination},function(e){g=angular.extend(g,e),P()})),r.$watchCollection(function(){return o.request},function(e){d&&d(),s=angular.extend({},b,e),s.hasOwnProperty("params")&&(d=r.$watchCollection(function(){return o.request.params},function(e){s.params=e,O.bOptionsValid&&o.autoLoad&&R()})),O.bOptionsValid&&o.autoLoad&&R()}),r.$on("$destroy",function(){f&&f.resolve()});var R=_.debounce(function(){a.info("DATASOURCE: Starting new data load"),e(function(){if(O.bOptionsValid&&O.bFilterValid){if(O.bLoading){if(angular.equals(O.currentRequestOptions,s))return;f.resolve()}w=!0,O.bLoading=!0,O.data=[],O.pageData=[],O.viewData=[],O.pages=0,f=t.defer(),s.timeout=f.promise,O.currentRequestOptions=angular.copy(s);var n=!0,r=0,i=0,l=o.requestDataFunction(s),c=new Date;l.then(function(){O.bLoading=!1,n&&(v?C():(O.bFiltering=!0,y())),t.when(h).then(function(){var t=new Date-c;if(a.info("DATASOURCE: Complete loading time: "+t+"ms"),w=!1,o.hasOwnProperty("onLoadComplete")){var n=new Date;e(function(){o.onLoadComplete();var e=new Date-n;a.info("DATASOURCE: Load complete function: "+e+"ms")},0)}})},function(){a.warn("DATASOURCE: Request cancelled"),O.bLoading=!1,O.bFiltering=!1,w=!1},function(e){var t=new Date;O.data.push.apply(O.data,e);var o=new Date-t;a.info("DATASOURCE: Loading new data: "+o+"ms"),1e3>r?(v?C():(O.bFiltering=!0,y()),n=!1,i=t,r=new Date-t):(n=!0,a.info("DATASOURCE: skipping sort/filter due to previous process time"),r-=new Date-i),i=t})}},0)},100);o.hasOwnProperty("requestValid")&&o.requestValid&&r.$watch(o.requestValid,function(e){O.bOptionsValid=!!e,O.bOptionsValid&&o.autoLoad&&R()});var $=null,S=null,y=function(){return S?e.cancel($):S=t.defer(),h=S.promise,$=e(function(){var e,t,n=0,r=[];if(O.bPaused){if(i){for(t=O.viewData.length;t>n;n++)e=O.viewData[n],i(e)&&r.push(e);O.viewData=r}}else{var o=new Date;if(i){for(t=O.data.length;t>n;n++)e=O.data[n],i(e)&&r.push(e);O.viewData=r}else O.viewData=O.data.slice(0);P(),O.bFiltering=!1;var l=new Date-o;a.info("DATASOURCE: Filter "+l+"ms")}S.resolve(),S=null},100),h},P=function(){g?(g.perPage=parseInt(g.perPage,10),(!g.perPage||g.perPage<=0)&&(g.perPage=D.perPage),O.pages=Math.ceil(O.viewData.length/g.perPage),O.currentPage=Math.min(O.currentPage,O.pages),O.currentPage<=0&&(O.currentPage=Math.min(1,O.pages)),p=g.perPage*(O.currentPage-1),m=Math.min(p+g.perPage,O.viewData.length),O.pageData=O.viewData.slice(p,m)):(O.pageData=O.viewData,O.viewData.length?(O.pages=1,O.currentPage=1):(O.pages=0,O.currentPage=0))},O={bLoading:!1,bFiltering:!1,bFilterValid:!0,bOptionsValid:!0,bPaused:!1,initialRequestOptions:o.request,currentRequestOptions:{},currentPage:0,data:[],viewData:[],pageData:[],pages:0,sortFunction:null,sortOrder:"ASC",setPage:function(e){O.currentPage=e,P()},loadData:function(){O.bPaused=!1,R()},cancelRequest:function(){f&&f.resolve()},pause:function(){O.bPaused=!0,O.bFiltering=!1},resume:function(){O.bPaused=!1,O.bFiltering=!0,y()}};return o.hasOwnProperty("filter")&&(i=o.filter.filterFunction,o.hasOwnProperty("filterValid")&&(c=r.$watch(o.filterValid,function(e){O.bFilterValid=!!e,!O.bLoading&&O.bFilterValid&&(O.bFiltering=!0,y())})),l=r.$watchCollection(function(){return o.filter.values},function(){O.bFilterValid&&(O.bFiltering=!0,y())})),O}};return r}]),angular.module("dcm-ui.grid").factory("filters",["$interpolate",function(e){var t=function(e){return void 0===e?"":e},a=function(e,t){var a={},n=[];if(a[t]=!0,e&&angular.isArray(e)&&e.length)for(var r=0;r<e.length;r++)a[e[r]]=!0;for(var o in a)n.push(o);return n},n={"new":function(n){var r={data:{},defaultValues:{},defaultParams:{},values:{},requestParams:{},filterFunctions:[]};return r.resetFilters=function(){angular.extend(r.values,r.defaultValues),angular.extend(r.requestParams,r.defaultParams)},r.addDefaultValue=function(e,a){r.defaultValues[e]=t(a),r.values[e]=r.defaultValues[e]},r.addDefaultParam=function(e,a){r.defaultParams[e]=t(a),r.requestParams[e]=r.defaultParams[e]},r.onChange=function(e,t,a){n.$watch(function(){return r[e][t]},a)},r.onCollectionChange=function(e,t,a){n.$watchCollection(function(){return r[e][t]},a)},r.addFilterExactMatchObject=function(e,t){r.filterFunctions.push(function(a,n){return r.data[t]&&!r.data[t][n[e]]?!1:!0})},r.addFilterInteger=function(e,t){var a;switch(t){case"lt":a=function(e,t){return t>e};break;case"gt":a=function(e,t){return e>t};break;case"eq":a=function(e,t){return e===t}}r.filterFunctions.push(function(t,n){return""===t[e]||a(parseInt(n[e],10),parseInt(t[e],10))?!0:!1})},r.addFilterExactMatch=function(e,t){var a=function(e,t){return e&&e.toLowerCase()===t.toLowerCase()?!0:!1};r.addFilterWithComparator(a,e,t)},r.addFilterPartialMatch=function(e,t){var a=function(e,t){return e&&-1!==e.toLowerCase().indexOf(t.toLowerCase())?!0:!1};r.addFilterWithComparator(a,e,t)},r.addFilterWithComparator=function(t,n,o){var i,l;o&&!angular.isArray(o)?i=e(o):l=a(o,n),r.filterFunctions.push(function(e,a){if(""!==e[n]){var r,o=e[n];if(i){if(r=i(a),t(r,o))return!0}else for(var c=0;c<l.length;c++)if(r=a[l[c]],t(r,o))return!0;return!1}return!0})},r.addFilterWhenValueIs=function(e,t){t=t.toString(),r.filterFunctions.push(function(a,n){return a[e]&&a[e].toString()===t&&n[e].toString()!==t?!1:!0})},r.setData=function(e,t){r.data[e]=t},r.filterFunction=function(e){for(var t=!0,a=angular.extend({},r.requestParams,r.values),n=0,o=r.filterFunctions.length;o>n;n++){if(!t)return t;t=r.filterFunctions[n](a,e)}return t},r.addStandardTextSearchFilter=function(e,t){r.addDefaultValue(e,""),r.addFilterPartialMatch(e,t)},r.addExactTextSearchFilter=function(e,t){r.addDefaultValue(e,""),r.addFilterExactMatch(e,t)},r}};return n}]);
//# sourceMappingURL=dcm-ui-grid.min.js.map