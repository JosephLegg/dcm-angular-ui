"use strict";angular.module("dcm-ui.resizable-cols",["dcm-ui.helpers.drag"]),angular.module("dcm-ui.resizable-cols").controller("ResizableColumnsCtrl",["$timeout",function(a){var b=this,c=b.cols=[],d=[];b.dragBox=angular.element('<div class="resizable-columns-drag-box" style="position: absolute;">'),b.dragBox.on("click",function(a){a.stopPropagation(),a.preventDefault()});var e=!1;b.addCol=function(f,g){c.push(f),d.push(g),e||(e=!0,a(b.resizeAll,0))},b.removeCol=function(a){var b=c.indexOf(a);c.splice(b,1),d.splice(b,1)},b.resizeAll=function(){e=!1}}]),angular.module("dcm-ui.resizable-cols").directive("resizableColumn",["$log","$document","$timeout","dragHelper",function(a,b,c,d){return{restrict:"AC",scope:!1,require:"^resizableColumns",compile:function(){return function(b,e,f,g){var h=e.next();if(!h.length||!h.hasClass("resizable-column")&&void 0===h.attr("resizable-column"))e.removeClass("resizable-column"),e.css("width","auto");else{e.addClass("resizable-column");var i=angular.element('<a class="resizable-columns-drag-handle"></a>');i.css({cursor:"col-resize",position:"absolute",display:"block",width:"10px"}),g.addCol(e,i);var j=function(){i.height(e.outerHeight(!1));var a=h.offset(),b=a.left-i.width()/2;i.offset({top:a.top,left:b})},k=b.$watch(function(){return h[0].offsetLeft+g.table[0].offsetLeft},function(b,c){b!==c&&Math.abs(c-b)>=1&&(a.info("RESIZABLE: position changed: "+e.text()+" "+(Math.round(100*(c-b))/100).toString()+"px"),j())});c(function(){g.table.after(i),j()},0);var l,m,n,o=function(a,b){return Math.round(Math.min(Math.max(b.current+a.dX,b.min),b.max))},p=function(a){var b=s(),c=o(a,b)-b.current;g.dragBox.offset({top:m,left:c}),i.offset({left:l.left+c})},q=function(a){g.dragBox.remove(),e.removeClass("resizing"),i.removeClass("resizing");var b=s();r(o(a,b)),j()},r=function(a){var c=s(),d=c.combined-a;Math.abs(a-c.current)>=1&&(c.nextResizable||h.css("width","auto"),a<c.current||!c.nextResizable?(e.width(a),d=c.combined-e.width(),c.nextResizable&&e.width()!==c.current&&h.width(d)):(h.width(d),a=c.combined-h.width(),h.width()!==c.currentNext&&e.width(a)),b.$emit("TABLE_COL_RESIZED"))},s=function(){var a=e.width(),b=h.width(),c=a+b,d=Math.round(u(e)),f=Math.round(u(h)),g=c-f;return{current:a,currentNext:b,combined:c,min:d,minNext:f,max:g,nextResizable:h.is(".resizable-column")}},t=function(){var b=s();b.combined<=b.min+b.minNext?a.info("RESIZABLE: both cols are too narrow to resize further"):(l=i.offset(),n=Math.round(h.offset().left-1),e.addClass("resizing"),i.addClass("resizing"),g.table.after(g.dragBox),m=g.table.offset().top,g.dragBox.height(g.table.height()).width(n).offset({top:m,left:0}))},u=function(a){var b=angular.element('<span style="display:inline; padding: 0; margin: 0;">');a.append(b),b.append(a.contents());var c=b.outerWidth(!0);return a.append(b.contents()),b.remove(),c},v=function(){var b=s();if(b.combined<=b.min+b.minNext)a.info("RESIZABLE: both cols are too narrow to resize further");else{r(b.max);var c=e.parent().children().index(e),d=Math.min(u(e),b.max),f=g.table.find("tbody>tr>td:nth-child("+(c+1).toString()+")");angular.forEach(f,function(a){d=Math.max(d,Math.min(u(angular.element(a)),b.max))}),r(d)}};d.draggable(i,{dragCursor:"col-resize",mouseUp:q,mouseDown:t,mouseMove:p,mouseDoubleClick:v}),e.on("$destroy",function(){k(),g.removeCol(e),i.remove()})}}}}}]),angular.module("dcm-ui.resizable-cols").directive("resizableColumns",[function(){return{restrict:"AC",controller:"ResizableColumnsCtrl",compile:function(){return function(a,b,c,d){b.addClass("resizable-columns"),d.table=b,d.visible=!1,a.$watch(function(){return b[0].offsetWidth},function(a){d.visible=!!a})}}}}]);
//# sourceMappingURL=dcm-ui-resizable-cols.min.js.map